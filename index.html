<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>My Store</title>
<style>
  /* ==== BASE STYLES ==== */
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 0; padding: 0;
    background: var(--bg-color);
    color: var(--text-color);
    transition: background 0.3s, color 0.3s;
  }
  :root {
    --bg-color: #fff;
    --text-color: #222;
    --primary-color: #007bff;
    --secondary-color: #555;
    --highlight-color: #28a745;
    --button-bg: var(--primary-color);
    --button-text: #fff;
    --input-bg: #fff;
    --input-border: #ccc;
    --header-bg: #f8f9fa;
    --card-bg: #fafafa;
  }
  body.dark {
    --bg-color: #121212;
    --text-color: #eee;
    --primary-color: #3399ff;
    --secondary-color: #aaa;
    --highlight-color: #44dd77;
    --button-bg: var(--primary-color);
    --button-text: #000;
    --input-bg: #222;
    --input-border: #555;
    --header-bg: #222;
    --card-bg: #1e1e1e;
  }

  a {
    color: var(--primary-color);
    text-decoration: none;
  }
  a:hover {
    text-decoration: underline;
  }

  /* ==== HEADER ==== */
  header {
    background: var(--header-bg);
    padding: 1rem;
    display: flex;
    align-items: center;
    justify-content: space-between;
    position: sticky;
    top: 0;
    z-index: 100;
  }
  header h1 {
    margin: 0;
    font-size: 1.5rem;
  }
  #dark-mode-toggle {
    cursor: pointer;
    background: var(--button-bg);
    color: var(--button-text);
    border: none;
    padding: 0.4rem 0.8rem;
    border-radius: 4px;
  }

  /* ==== MAIN CONTAINER ==== */
  main {
    max-width: 1100px;
    margin: 1rem auto;
    padding: 0 1rem;
  }

  /* ==== LOGIN ==== */
  #login-section {
    max-width: 400px;
    margin: 4rem auto;
    background: var(--card-bg);
    padding: 2rem;
    border-radius: 8px;
    box-shadow: 0 0 8px rgba(0,0,0,0.1);
  }
  #login-section h2 {
    text-align: center;
    margin-bottom: 1rem;
  }
  #login-section label {
    display: block;
    margin: 0.8rem 0 0.2rem;
  }
  #login-section input[type=email],
  #login-section input[type=password] {
    width: 100%;
    padding: 0.6rem;
    border: 1px solid var(--input-border);
    border-radius: 4px;
    background: var(--input-bg);
    color: var(--text-color);
  }
  #login-section button {
    margin-top: 1rem;
    width: 100%;
    padding: 0.8rem;
    background: var(--button-bg);
    color: var(--button-text);
    border: none;
    border-radius: 4px;
    font-weight: 600;
    cursor: pointer;
  }

  /* ==== ADMIN PANEL ==== */
  #admin-panel {
    display: none;
  }
  #admin-panel h2 {
    margin-top: 0;
  }
  #admin-tabs {
    display: flex;
    gap: 1rem;
    margin-bottom: 1rem;
    flex-wrap: wrap;
  }
  #admin-tabs button {
    background: var(--button-bg);
    color: var(--button-text);
    border: none;
    padding: 0.5rem 1rem;
    border-radius: 5px;
    cursor: pointer;
  }
  #admin-tabs button.active {
    background: var(--highlight-color);
    color: #000;
  }

  /* ==== ADMIN SECTIONS ==== */
  .admin-section {
    display: none;
  }
  .admin-section.active {
    display: block;
  }

  /* ==== PRODUCTS ADMIN ==== */
  #product-form {
    background: var(--card-bg);
    padding: 1rem;
    border-radius: 8px;
    margin-bottom: 1rem;
  }
  #product-form label {
    display: block;
    margin: 0.5rem 0 0.2rem;
  }
  #product-form input[type=text],
  #product-form input[type=number],
  #product-form textarea {
    width: 100%;
    padding: 0.5rem;
    border: 1px solid var(--input-border);
    border-radius: 4px;
    background: var(--input-bg);
    color: var(--text-color);
    resize: vertical;
  }
  #product-form textarea {
    height: 80px;
  }
  #product-form button {
    margin-top: 0.8rem;
    padding: 0.6rem 1rem;
    background: var(--button-bg);
    color: var(--button-text);
    border: none;
    border-radius: 5px;
    cursor: pointer;
  }
  #product-list {
    margin-top: 1rem;
  }
  .product-item-admin {
    background: var(--card-bg);
    padding: 0.6rem;
    margin-bottom: 0.5rem;
    border-radius: 6px;
    display: flex;
    align-items: center;
    justify-content: space-between;
  }
  .product-item-admin div {
    flex: 1;
    margin-left: 1rem;
  }
  .product-item-admin img {
    width: 60px;
    height: 60px;
    object-fit: contain;
    border-radius: 4px;
    border: 1px solid var(--input-border);
  }
  .product-item-admin button {
    margin-left: 0.5rem;
    background: #dc3545;
    color: #fff;
    border: none;
    padding: 0.3rem 0.6rem;
    border-radius: 4px;
    cursor: pointer;
  }

  /* ==== STORE CUSTOMIZATION ==== */
  #store-customization label {
    display: block;
    margin: 0.5rem 0 0.2rem;
  }
  #store-customization input[type=text],
  #store-customization textarea,
  #store-customization select {
    width: 100%;
    padding: 0.5rem;
    border: 1px solid var(--input-border);
    border-radius: 4px;
    background: var(--input-bg);
    color: var(--text-color);
  }
  #store-customization textarea {
    height: 100px;
  }
  #store-customization button {
    margin-top: 1rem;
    padding: 0.6rem 1rem;
    background: var(--button-bg);
    color: var(--button-text);
    border: none;
    border-radius: 4px;
    cursor: pointer;
  }
  #background-patterns {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
    margin-top: 0.5rem;
  }
  .pattern-option {
    width: 48px;
    height: 48px;
    border-radius: 6px;
    cursor: pointer;
    border: 2px solid transparent;
    background-size: cover;
    background-position: center;
  }
  .pattern-option.selected {
    border-color: var(--highlight-color);
  }

  /* ==== STORE FRONT ==== */
  #shopping-area {
    display: none;
  }
  #products-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1rem;
  }
  .product-card {
    background: var(--card-bg);
    border-radius: 8px;
    padding: 1rem;
    box-shadow: 0 0 5px rgba(0,0,0,0.1);
    display: flex;
    flex-direction: column;
    justify-content: space-between;
  }
  .product-card img {
    width: 100%;
    height: 140px;
    object-fit: contain;
    border-radius: 4px;
  }
  .product-card h3 {
    margin: 0.5rem 0 0.2rem;
    font-size: 1.1rem;
  }
  .product-card p {
    flex: 1;
    font-size: 0.9rem;
    margin: 0.3rem 0;
  }
  .product-card select,
  .product-card input[type=number] {
    margin-top: 0.5rem;
    width: 100%;
    padding: 0.4rem;
    border-radius: 4px;
    border: 1px solid var(--input-border);
    background: var(--input-bg);
    color: var(--text-color);
  }
  .quantity-selector {
    display: flex;
    align-items: center;
    margin-top: 0.5rem;
  }
  .quantity-selector button {
    padding: 0.3rem 0.6rem;
    font-size: 1.1rem;
    background: var(--button-bg);
    color: var(--button-text);
    border: none;
    cursor: pointer;
    border-radius: 4px;
  }
  .quantity-selector input {
    width: 40px;
    text-align: center;
    border: 1px solid var(--input-border);
    margin: 0 0.3rem;
    border-radius: 4px;
    padding: 0.2rem 0;
    background: var(--input-bg);
    color: var(--text-color);
  }
  .add-to-cart-btn {
    margin-top: 0.7rem;
    padding: 0.6rem;
    width: 100%;
    background: var(--highlight-color);
    color: #000;
    border: none;
    cursor: pointer;
    border-radius: 5px;
    font-weight: 600;
  }

  /* ==== PAGINATION ==== */
  #pagination {
    margin: 1rem 0;
    text-align: center;
  }
  #pagination button {
    background: var(--button-bg);
    border: none;
    color: var(--button-text);
    margin: 0 0.25rem;
    padding: 0.4rem 0.8rem;
    border-radius: 4px;
    cursor: pointer;
  }
  #pagination button.disabled {
    opacity: 0.5;
    cursor: default;
  }
  #pagination button.active {
    background: var(--highlight-color);
    color: #000;
  }

  /* ==== CART ==== */
  #cart-area {
    display: none;
  }
  #cart-items {
    margin-top: 1rem;
  }
  .cart-item {
    background: var(--card-bg);
    padding: 0.6rem;
    border-radius: 6px;
    display: flex;
    align-items: center;
    margin-bottom: 0.6rem;
  }
  .cart-item img {
    width: 60px;
    height: 60px;
    object-fit: contain;
    border-radius: 4px;
  }
  .cart-item-info {
    flex: 1;
    margin-left: 1rem;
  }
  .cart-item-info p {
    margin: 0.1rem 0;
  }
  .cart-item-qty {
    display: flex;
    align-items: center;
  }
  .cart-item-qty button {
    padding: 0.2rem 0.5rem;
    background: var(--button-bg);
    border: none;
    color: var(--button-text);
    font-weight: 700;
    cursor: pointer;
    border-radius: 4px;
    margin: 0 0.2rem;
  }
  .cart-item-qty input {
    width: 40px;
    text-align: center;
    border: 1px solid var(--input-border);
    border-radius: 4px;
    padding: 0.15rem 0;
    background: var(--input-bg);
    color: var(--text-color);
  }
  #cart-summary {
    margin-top: 1rem;
    font-weight: 700;
  }
  #checkout-btn {
    margin-top: 1rem;
    padding: 0.8rem;
    width: 100%;
    background: var(--highlight-color);
    border: none;
    cursor: pointer;
    font-weight: 700;
    color: #000;
    border-radius: 5px;
  }

  /* ==== CHECKOUT ==== */
  #checkout-area {
    display: none;
    max-width: 600px;
    margin: 0 auto 2rem;
  }
  #checkout-area h2 {
    margin-top: 0;
  }
  #checkout-form label {
    display: block;
    margin: 0.5rem 0 0.2rem;
  }
  #checkout-form input[type=text],
  #checkout-form input[type=email],
  #checkout-form input[type=tel],
  #checkout-form select,
  #checkout-form textarea {
    width: 100%;
    padding: 0.5rem;
    border-radius: 4px;
    border: 1px solid var(--input-border);
    background: var(--input-bg);
    color: var(--text-color);
  }
  #checkout-form textarea {
    height: 60px;
  }
  #shipping-message {
    margin-top: 0.5rem;
    font-style: italic;
    color: var(--secondary-color);
  }
  #place-order-btn {
    margin-top: 1rem;
    padding: 0.8rem;
    width: 100%;
    background: var(--highlight-color);
    border: none;
    cursor: pointer;
    font-weight: 700;
    color: #000;
    border-radius: 5px;
  }
  #bank-details {
    margin-top: 1rem;
    font-weight: 700;
    background: var(--card-bg);
    padding: 1rem;
    border-radius: 6px;
    text-align: center;
  }

  /* ==== WHATSAPP BUTTON ==== */
  #whatsapp-button {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: #25d366;
    border-radius: 50%;
    width: 52px;
    height: 52px;
    display: flex;
    justify-content: center;
    align-items: center;
    box-shadow: 0 0 8px #25d366aa;
    cursor: pointer;
    z-index: 1000;
  }
  #whatsapp-button svg {
    width: 28px;
    height: 28px;
    fill: white;
  }

  /* ==== MISC ==== */
  button:disabled,
  button.disabled {
    cursor: default;
    opacity: 0.6;
  }

  /* ==== ALERT ==== */
  #alert-box {
    position: fixed;
    top: 10px;
    left: 50%;
    transform: translateX(-50%);
    background: var(--highlight-color);
    color: #000;
    padding: 0.7rem 1.2rem;
    border-radius: 6px;
    box-shadow: 0 0 8px var(--highlight-color);
    display: none;
    z-index: 1100;
  }
</style>
</head>
<body>
<header>
  <h1 id="store-name">My Store</h1>
  <button id="dark-mode-toggle" aria-label="Toggle Dark Mode">🌙</button>
</header>

<main>

  <!-- LOGIN SECTION -->
  <section id="login-section">
    <h2>Admin Login</h2>
    <p id="login-instruction">No admin exists. Create your admin account below:</p>
    <form id="login-form">
      <label for="login-email">Email</label>
      <input type="email" id="login-email" required autocomplete="username" />
      <label for="login-password">Password</label>
      <input type="password" id="login-password" required autocomplete="current-password" />
      <button type="submit" id="login-btn">Login / Create Admin</button>
    </form>
  </section>

  <!-- ADMIN PANEL -->
  <section id="admin-panel" aria-label="Admin Dashboard">
    <h2>Admin Dashboard</h2>

    <div id="admin-tabs" role="tablist" aria-label="Admin sections">
      <button role="tab" id="tab-products" aria-selected="true">Products</button>
      <button role="tab" id="tab-customization" aria-selected="false">Store Design & Settings</button>
      <button role="tab" id="tab-orders" aria-selected="false">Orders</button>
      <button role="tab" id="admin-logout-btn" style="margin-left:auto; background:#dc3545;">Logout</button>
    </div>

    <!-- Products Admin -->
    <div class="admin-section active" id="products-section" role="tabpanel" aria-labelledby="tab-products">
      <form id="product-form" aria-label="Add or edit product">
        <input type="hidden" id="edit-product-id" />
        <label for="product-name">Product Name</label>
        <input type="text" id="product-name" placeholder="Product name" required />

        <label for="product-price">Price (₦)</label>
        <input type="number" id="product-price" placeholder="Price in Naira" min="0" step="100" required />

        <label for="product-description">Description</label>
        <textarea id="product-description" placeholder="Description"></textarea>

        <label for="product-colors">Colors (one per line)</label>
        <textarea id="product-colors" placeholder="Enter each color on its own line"></textarea>

        <label for="product-sizes">Sizes (one per line)</label>
        <textarea id="product-sizes" placeholder="Enter each size on its own line"></textarea>

        <label for="product-stock">Stock Quantity</label>
        <input type="number" id="product-stock" min="0" step="1" value="0" required />

        <label for="product-image">Image URL (or base64 string)</label>
        <input type="text" id="product-image" placeholder="Image URL or base64 string" />

        <button type="submit" id="save-product-btn">Add Product</button>
        <button type="button" id="cancel-edit-btn" style="display:none; margin-left:10px;">Cancel Edit</button>
      </form>

      <div id="product-list" aria-live="polite" aria-atomic="true" aria-relevant="all" style="margin-top: 1rem;">
        <!-- Product items go here -->
      </div>
    </div>

    <!-- Store Customization -->
    <div class="admin-section" id="customization-section" role="tabpanel" aria-labelledby="tab-customization">
      <h3>Store Design & Settings</h3>
      <form id="store-customization">
        <label for="store-name-input">Store Name</label>
        <input type="text" id="store-name-input" placeholder="My Store" />

        <label for="whatsapp-number-input">WhatsApp Number (with country code, e.g. +2348012345678)</label>
        <input type="text" id="whatsapp-number-input" placeholder="+2348012345678" />

        <label for="background-pattern-select">Background Pattern</label>
        <select id="background-pattern-select">
          <option value="">None</option>
          <option value="butterfly">Butterflies</option>
          <option value="spiral">Spirals</option>
          <option value="hearts">Hearts</option>
        </select>

        <label for="primary-color-input">Primary Color (Buttons, links)</label>
        <input type="color" id="primary-color-input" value="#007bff" />

        <label for="highlight-color-input">Highlight Color (e.g. cart buttons)</label>
        <input type="color" id="highlight-color-input" value="#28a745" />

        <label for="font-select">Font Family</label>
        <select id="font-select">
          <option value="'Segoe UI', Tahoma, Geneva, Verdana, sans-serif" selected>Segoe UI</option>
          <option value="Arial, Helvetica, sans-serif">Arial</option>
          <option value="'Courier New', Courier, monospace">Courier New</option>
          <option value="'Georgia', serif">Georgia</option>
          <option value="'Times New Roman', Times, serif">Times New Roman</option>
          <option value="'Trebuchet MS', sans-serif">Trebuchet MS</option>
        </select>

        <button type="submit" id="save-customization-btn">Save Settings</button>
      </form>
    </div>

    <!-- Orders Section -->
    <div class="admin-section" id="orders-section" role="tabpanel" aria-labelledby="tab-orders">
      <h3>Orders</h3>
      <div id="orders-list" aria-live="polite" aria-atomic="true" aria-relevant="all">
        <!-- Orders will be listed here -->
      </div>
    </div>
  </section>

  <!-- CUSTOMER SHOPPING AREA -->
  <section id="shopping-area" aria-label="Shopping area" style="display:none;">
    <h2>Products</h2>
    <div id="collections-filter" style="margin-bottom:1rem;">
      <label for="collection-select">Browse Collections:</label>
      <select id="collection-select">
        <option value="all">All</option>
      </select>
    </div>
    <div id="products-grid" aria-live="polite" aria-atomic="true" aria-relevant="all">
      <!-- Products grid here -->
    </div>
    <div id="pagination" role="navigation" aria-label="Product pagination">
      <!-- Pagination buttons -->
    </div>
    <button id="view-cart-btn" style="margin-top: 1rem;">View Cart (<span id="cart-count">0</span>)</button>
  </section>

  <!-- CART AREA -->
  <section id="cart-area" aria-label="Shopping cart" style="display:none;">
    <h2>Your Cart</h2>
    <div id="cart-items" aria-live="polite" aria-atomic="true" aria-relevant="all">
      <!-- Cart items -->
    </div>
    <div id="cart-summary">
      <p>Subtotal: ₦<span id="cart-subtotal">0</span></p>
      <p>Delivery Fee: ₦<span id="cart-shipping-fee">0</span></p>
      <p><strong>Total: ₦<span id="cart-total">0</span></strong></p>
    </div>
    <button id="checkout-btn">Proceed to Checkout</button>
    <button id="continue-shopping-btn" style="margin-left: 10px;">Continue Shopping</button>
  </section>

  <!-- CHECKOUT AREA -->
  <section id="checkout-area" aria-label="Checkout" style="display:none;">
    <h2>Checkout</h2>
    <form id="checkout-form">
      <label for="checkout-name">Full Name</label>
      <input type="text" id="checkout-name" required />

      <label for="checkout-email">Email</label>
      <input type="email" id="checkout-email" required />

      <label for="checkout-phone">Phone Number</label>
      <input type="tel" id="checkout-phone" required />

      <label for="checkout-address">Delivery Address</label>
      <textarea id="checkout-address" required></textarea>

      <label for="delivery-area-select">Delivery Area</label>
      <select id="delivery-area-select" required>
        <option value="">Select your delivery area</option>
        <option value="Lagos Mainland">Lagos Mainland (₦500)</option>
        <option value="Lagos Island">Lagos Island (₦700)</option>
        <option value="Outside Lagos">Outside Lagos (₦1000)</option>
        <option value="Others">Others (Contact on WhatsApp)</option>
      </select>
      <div id="shipping-message"></div>

      <button type="submit" id="place-order-btn">Place Order</button>
    </form>

    <div id="bank-details">
      <p>Transfer payment to:</p>
      <p><strong id="bank-details-text">Demo Bank — 0000000000</strong></p>
      <p>After payment, click the “I’ve Paid” button in your order confirmation email.</p>
    </div>
    <button id="back-to-cart-btn" style="margin-top:1rem;">Back to Cart</button>
  </section>

</main>

<!-- WHATSAPP BUTTON -->
<div id="whatsapp-button" title="Contact us on WhatsApp" role="button" tabindex="0" aria-label="WhatsApp Contact">
  <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
    <path d="M20.52 3.48a11.93 11.93 0 0 0-16.91 0 11.84 11.84 0 0 0-3.44 8.42 11.6 11.6 0 0 0 2.01 6.48L1 23l5.68-1.51a11.65 11.65 0 0 0 6.39 1.9c6.62 0 12-5.38 12-12a11.83 11.83 0 0 0-3.55-8.4zm-8.6 15.04a7.12 7.12 0 0 1-3.63-1.01l-.26-.16-3.37.9.9-3.28-.17-.28a7.18 7.18 0 0 1 1-6.21 6.97 6.97 0 0 1 12.01 4.32 6.81 6.81 0 0 1-1.99 4.9 6.61 6.61 0 0 1-4.06 1.44zm3.82-5.45c-.21-.1-1.24-.61-1.43-.68-.19-.07-.33-.1-.48.1s-.55.67-.68.8-.25.15-.46.05a5.15 5.15 0 0 1-1.5-.88 5.81 5.81 0 0 1-1.08-1.34c-.11-.19-.01-.29.08-.39.08-.08.19-.21.29-.31a.64.64 0 0 0 .1-.2c0-.06 0-.12-.02-.17-.05-.09-.45-1.08-.62-1.47s-.34-.33-.48-.34a.54.54 0 0 0-.38 0c-.13 0-.28.1-.43.29-.15.18-.59.58-.59 1.42s.61 1.65.69 1.77c.08.12 1.18 1.8 2.86 2.52a10.11 10.11 0 0 0 1.66.68c.7.22 1.34.19 1.85.12.57-.08 1.74-.71 1.99-1.4.25-.7.25-1.3.18-1.4-.07-.1-.19-.15-.4-.25z"/>
  </svg>
</div>

<!-- ALERT BOX -->
<div id="alert-box" role="alert"></div>

<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
<script>
  (function() {
    emailjs.init("RN5H1CcY7Fqkakg5w"); // YOUR PUBLIC KEY here

    // ---- STORAGE KEYS ----
    const ADMIN_KEY = 'my_store_admin';
    const PRODUCTS_KEY = 'my_store_products';
    const ORDERS_KEY = 'my_store_orders';
    const SETTINGS_KEY = 'my_store_settings';
    const CART_KEY = 'my_store_cart';

    // ---- STATE ----
    let currentUser = null; // admin object {email, password} when logged in
    let products = [];
    let orders = [];
    let settings = {};
    let cart = [];
    let editingProductId = null;
    let currentPage = 1;
    const PRODUCTS_PER_PAGE = 6;

    // DOM ELEMENTS
    const loginSection = document.getElementById('login-section');
    const loginForm = document.getElementById('login-form');
    const loginEmailInput = document.getElementById('login-email');
    const loginPasswordInput = document.getElementById('login-password');
    const loginInstruction = document.getElementById('login-instruction');
    const adminPanel = document.getElementById('admin-panel');
    const adminTabs = document.getElementById('admin-tabs');
    const productsSection = document.getElementById('products-section');
    const customizationSection = document.getElementById('customization-section');
    const ordersSection = document.getElementById('orders-section');
    const storeNameHeader = document.getElementById('store-name');
    const productForm = document.getElementById('product-form');
    const productNameInput = document.getElementById('product-name');
    const productPriceInput = document.getElementById('product-price');
    const productDescriptionInput = document.getElementById('product-description');
    const productColorsInput = document.getElementById('product-colors');
    const productSizesInput = document.getElementById('product-sizes');
    const productStockInput = document.getElementById('product-stock');
    const productImageInput = document.getElementById('product-image');
    const saveProductBtn = document.getElementById('save-product-btn');
    const cancelEditBtn = document.getElementById('cancel-edit-btn');
    const productListDiv = document.getElementById('product-list');
    const storeCustomizationForm = document.getElementById('store-customization');
    const storeNameInput = document.getElementById('store-name-input');
    const whatsappNumberInput = document.getElementById('whatsapp-number-input');
    const backgroundPatternSelect = document.getElementById('background-pattern-select');
    const primaryColorInput = document.getElementById('primary-color-input');
    const highlightColorInput = document.getElementById('highlight-color-input');
    const fontSelect = document.getElementById('font-select');
    const ordersListDiv = document.getElementById('orders-list');
    const adminLogoutBtn = document.getElementById('admin-logout-btn');

    const shoppingArea = document.getElementById('shopping-area');
    const collectionSelect = document.getElementById('collection-select');
    const productsGrid = document.getElementById('products-grid');
    const paginationDiv = document.getElementById('pagination');
    const viewCartBtn = document.getElementById('view-cart-btn');

    const cartArea = document.getElementById('cart-area');
    const cartItemsDiv = document.getElementById('cart-items');
    const cartSubtotalSpan = document.getElementById('cart-subtotal');
    const cartShippingFeeSpan = document.getElementById('cart-shipping-fee');
    const cartTotalSpan = document.getElementById('cart-total');
    const checkoutBtn = document.getElementById('checkout-btn');
    const continueShoppingBtn = document.getElementById('continue-shopping-btn');

    const checkoutArea = document.getElementById('checkout-area');
    const checkoutForm = document.getElementById('checkout-form');
    const checkoutNameInput = document.getElementById('checkout-name');
    const checkoutEmailInput = document.getElementById('checkout-email');
    const checkoutPhoneInput = document.getElementById('checkout-phone');
    const checkoutAddressInput = document.getElementById('checkout-address');
    const deliveryAreaSelect = document.getElementById('delivery-area-select');
    const shippingMessageDiv = document.getElementById('shipping-message');
    const placeOrderBtn = document.getElementById('place-order-btn');
    const bankDetailsText = document.getElementById('bank-details-text');
    const backToCartBtn = document.getElementById('back-to-cart-btn');

    const darkModeToggle = document.getElementById('dark-mode-toggle');
    const whatsappButton = document.getElementById('whatsapp-button');

    const alertBox = document.getElementById('alert-box');

    // ===== HELPERS =====

    function showAlert(message, duration = 3000) {
      alertBox.textContent = message;
      alertBox.style.display = 'block';
      setTimeout(() => {
        alertBox.style.display = 'none';
      }, duration);
    }

    function saveAdmin(user) {
      localStorage.setItem(ADMIN_KEY, JSON.stringify(user));
    }
    function getAdmin() {
      const adminStr = localStorage.getItem(ADMIN_KEY);
      return adminStr ? JSON.parse(adminStr) : null;
    }

    function saveProducts() {
      localStorage.setItem(PRODUCTS_KEY, JSON.stringify(products));
    }
    function loadProducts() {
      const prods = localStorage.getItem(PRODUCTS_KEY);
      products = prods ? JSON.parse(prods) : [];
    }

    function saveOrders() {
      localStorage.setItem(ORDERS_KEY, JSON.stringify(orders));
    }
    function loadOrders() {
      const ords = localStorage.getItem(ORDERS_KEY);
      orders = ords ? JSON.parse(ords) : [];
    }

    function saveSettings() {
      localStorage.setItem(SETTINGS_KEY, JSON.stringify(settings));
    }
    function loadSettings() {
      const sets = localStorage.getItem(SETTINGS_KEY);
      if (sets) {
        settings = JSON.parse(sets);
      } else {
        settings = {
          storeName: "My Store",
          whatsappNumber: "",
          backgroundPattern: "",
          primaryColor: "#007bff",
          highlightColor: "#28a745",
          fontFamily: "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",
          bankDetails: "Demo Bank — 0000000000"
        };
        saveSettings();
      }
    }

    function saveCart() {
      localStorage.setItem(CART_KEY, JSON.stringify(cart));
    }
    function loadCart() {
      const crt = localStorage.getItem(CART_KEY);
      cart = crt ? JSON.parse(crt) : [];
    }

    function setCSSVariables() {
      document.documentElement.style.setProperty('--primary-color', settings.primaryColor);
      document.documentElement.style.setProperty('--highlight-color', settings.highlightColor);
      document.documentElement.style.setProperty('--button-bg', settings.primaryColor);
      document.documentElement.style.setProperty('--button-text', getContrastYIQ(settings.primaryColor));
      document.documentElement.style.setProperty('--font-family', settings.fontFamily);
      document.body.style.fontFamily = settings.fontFamily;

      // Background pattern
      if (settings.backgroundPattern) {
        let bgUrl = "";
        switch (settings.backgroundPattern) {
          case "butterfly":
            bgUrl = "https://i.ibb.co/YZ6H49s/butterfly.png";
            break;
          case "spiral":
            bgUrl = "https://i.ibb.co/89P8bQq/spiral.png";
            break;
          case "hearts":
            bgUrl = "https://i.ibb.co/2FpqLGb/hearts.png";
            break;
          default:
            bgUrl = "";
        }
        if (bgUrl) {
          document.body.style.backgroundImage = `url(${bgUrl})`;
          document.body.style.backgroundRepeat = "repeat";
          document.body.style.backgroundSize = "80px 80px";
        } else {
          document.body.style.backgroundImage = "";
        }
      } else {
        document.body.style.backgroundImage =
